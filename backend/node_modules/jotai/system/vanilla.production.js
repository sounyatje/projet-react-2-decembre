System.register([],function(z){"use strict";return{execute:function(){z("atom",P);let N=0;function P(t,r){const l=`atom${++N}`,d={toString(){return l}};return typeof t=="function"?d.read=t:(d.init=t,d.read=R,d.write=T),r&&(d.write=r),d}function R(t){return t(this)}function T(t,r,l){return r(this,typeof l=="function"?l(t(this)):l)}const O=(t,r)=>t.unstable_is?t.unstable_is(r):r===t,q=t=>"init"in t,B=t=>!!t.write,b=new WeakMap,A=t=>{var r;return C(t)&&!((r=b.get(t))!=null&&r[1])},U=(t,r)=>{const l=b.get(t);l&&(l[1]=!0,l[0].forEach(d=>d(r)))},$=t=>{if(b.has(t))return;const r=[new Set,!1];b.set(t,r);const l=()=>{r[1]=!0};t.then(l,l),t.onCancel=d=>{r[0].add(d)}},C=t=>typeof(t==null?void 0:t.then)=="function",F=t=>"v"in t||"e"in t,k=t=>{if("e"in t)throw t.e;return t.v},G=(t,r,l)=>{l.p.has(t)||(l.p.add(t),r.then(()=>{l.p.delete(t)},()=>{l.p.delete(t)}))},H=(t,r,l,d,v)=>{var m;l.d.set(d,v.n),A(l.v)&&G(r,l.v,v),(m=v.m)==null||m.t.add(r),t&&x(t,d,r)},g=()=>[new Map,new Map,new Set],I=(t,r,l)=>{t[0].has(r)||t[0].set(r,new Set),t[1].set(r,l)},x=(t,r,l)=>{const d=t[0].get(r);d&&d.add(l)},Q=(t,r)=>t[0].get(r),J=(t,r)=>{t[2].add(r)},p=t=>{let r,l=!1;const d=v=>{try{v()}catch(m){l||(r=m,l=!0)}};for(;t[1].size||t[2].size;){t[0].clear();const v=new Set(t[1].values());t[1].clear();const m=new Set(t[2]);t[2].clear(),v.forEach(D=>{var E;return(E=D.m)==null?void 0:E.l.forEach(d)}),m.forEach(d)}if(l)throw r},K=(...[t,r,l,d])=>{const v=(c,e,n)=>{const u="v"in e,o=e.v,a=A(e.v)?e.v:null;if(C(n)){$(n);for(const s of e.d.keys())G(c,n,t(s));e.v=n,delete e.e}else e.v=n,delete e.e;(!u||!Object.is(o,e.v))&&(++e.n,a&&U(a,n))},m=(c,e,n)=>{var u;const o=t(e);if(F(o)&&(o.m&&!(n!=null&&n.has(e))||Array.from(o.d).every(([f,y])=>m(c,f,n).n===y)))return o;o.d.clear();let a=!0;const s=f=>{if(O(e,f)){const S=t(f);if(!F(S))if(q(f))v(f,S,f.init);else throw new Error("no atom init");return k(S)}const y=m(c,f,n);try{return k(y)}finally{if(a)H(c,e,o,f,y);else{const S=g();H(S,e,o,f,y),M(S,e,o),p(S)}}};let i,h;const w={get signal(){return i||(i=new AbortController),i.signal},get setSelf(){return!h&&B(e)&&(h=(...f)=>{if(!a)return L(e,...f)}),h}};try{const f=r(e,s,w);if(v(e,o,f),C(f)){(u=f.onCancel)==null||u.call(f,()=>i==null?void 0:i.abort());const y=()=>{if(o.m){const S=g();M(S,e,o),p(S)}};f.then(y,y)}return o}catch(f){return delete o.v,o.e=f,++o.n,o}finally{a=!1}},D=c=>k(m(void 0,c)),E=(c,e,n)=>{var u,o;const a=new Map;for(const s of((u=n.m)==null?void 0:u.t)||[])a.set(s,t(s));for(const s of n.p)a.set(s,t(s));return(o=Q(c,e))==null||o.forEach(s=>{a.set(s,t(s))}),a};function Y(c,e,n){const u=[],o=new Set,a=new Set,s=[[e,n]];for(;s.length>0;){const[i,h]=s[s.length-1];if(a.has(i)){s.pop();continue}if(o.has(i)){u.push([i,h,h.n]),a.add(i),s.pop();continue}o.add(i);for(const[w,f]of E(c,i,h))i!==w&&!o.has(w)&&s.push([w,f])}return[u,a]}const Z=(c,e,n)=>{const[u,o]=Y(c,e,n),a=new Set([e]);for(let s=u.length-1;s>=0;--s){const[i,h,w]=u[s];let f=!1;for(const y of h.d.keys())if(y!==i&&a.has(y)){f=!0;break}f&&(m(c,i,o),M(c,i,h),w!==h.n&&(I(c,i,h),a.add(i))),o.delete(i)}},V=(c,e,...n)=>{let u=!0;const o=s=>k(m(c,s)),a=(s,...i)=>{const h=t(s);try{if(O(e,s)){if(!q(s))throw new Error("atom not writable");const w=h.n,f=i[0];v(s,h,f),M(c,s,h),w!==h.n&&(I(c,s,h),Z(c,s,h));return}else return V(c,s,...i)}finally{u||p(c)}};try{return l(e,o,a,...n)}finally{u=!1}},L=(c,...e)=>{const n=g();try{return V(n,c,...e)}finally{p(n)}},M=(c,e,n)=>{if(n.m&&!A(n.v)){for(const u of n.d.keys())n.m.d.has(u)||(W(c,u,t(u)).t.add(e),n.m.d.add(u));for(const u of n.m.d||[])if(!n.d.has(u)){n.m.d.delete(u);const o=j(c,u,t(u));o==null||o.t.delete(e)}}},W=(c,e,n)=>{if(!n.m){m(c,e);for(const u of n.d.keys())W(c,u,t(u)).t.add(e);if(n.m={l:new Set,d:new Set(n.d.keys()),t:new Set},B(e)){const u=n.m;let o;const a=(s,i)=>{let h=!0;o=(...w)=>{try{return V(s,e,...w)}finally{h||p(s)}};try{return i()}finally{h=!1}};J(c,()=>{const s=a(c,()=>d(e,(...i)=>o(...i)));s&&(u.u=i=>a(i,s))})}}return n.m},j=(c,e,n)=>{if(n.m&&!n.m.l.size&&!Array.from(n.m.t).some(u=>{var o;return(o=t(u).m)==null?void 0:o.d.has(e)})){const u=n.m.u;u&&J(c,()=>u(c)),delete n.m;for(const o of n.d.keys()){const a=j(c,o,t(o));a==null||a.t.delete(e)}return}return n.m};return{get:D,set:L,sub:(c,e)=>{const n=g(),u=t(c),o=W(n,c,u).l;return o.add(e),p(n),()=>{o.delete(e);const a=g();j(a,c,u),p(a)}},unstable_derive:c=>K(...c(t,r,l,d))}},X=z("createStore",()=>{const t=new WeakMap;return K(r=>{let l=t.get(r);return l||(l={d:new Map,p:new Set,n:0},t.set(r,l)),l},(r,...l)=>r.read(...l),(r,...l)=>r.write(...l),(r,...l)=>{var d;return(d=r.onMount)==null?void 0:d.call(r,...l)})});let _;const tt=z("getDefaultStore",()=>(_||(_=X()),_))}}});
